const path = require('path');
// your app's webpack.config.js
const custom = require('../webpack.config.js');

module.exports = async ({ config, mode }) => {
  let rules = config.module.rules ? config.module.rules : [];
  rules.push({
    test: /\.story\.js?$/,
    loaders: [require.resolve('@storybook/addon-storysource/loader')],
    enforce: 'pre',
  });
  if (custom.module && custom.module.rules) {
    rules = rules.concat(custom.module.rules);
  }

  return {
    ...config,
    // ...custom,
    module: {
      ...config.module,
      // ...custom.module,
      rules: rules
    }
  };
};

